

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Welcome &mdash; ATS CMake latest documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     'latest',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ATS CMake latest documentation" href="#" />
    <link rel="next" title="Examples" href="examples.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             accesskey="N">next</a> |</li>
        <li><a href="#">ATS CMake latest documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="welcome">
<h1>Welcome<a class="headerlink" href="#welcome" title="Permalink to this headline">¶</a></h1>
<p>This is a project aiming at developing a build tool for ATS. It is based on CMake. Currently, it provides some very useful CMake modules for ATS users to simplify building processes. In the near future, it will support downloading artifacts from a server to help you utilize third party ATS libraries.</p>
<p>The project is hosted on <a class="reference external" href="https://github.com/steinwaywhw/ATS-CMake">GitHub</a>. Welcome to contribute.</p>
</div>
<div class="section" id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html#multiple-executables">Multiple Executables</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html#local-cmake-modules">Local CMake Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="inside.html">Inside the Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="inside.html#findats-module">FindATS Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="inside.html#find-package-ats-required"><tt class="docutils literal"><span class="pre">FIND_PACKAGE</span> <span class="pre">(ATS</span> <span class="pre">REQUIRED)</span></tt></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="inside.html#atscc-module">ATSCC Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="inside.html#ats-include-path"><tt class="docutils literal"><span class="pre">ATS_INCLUDE</span> <span class="pre">(path</span> <span class="pre">...)</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="inside.html#ats-compile-output-src"><tt class="docutils literal"><span class="pre">ATS_COMPILE</span> <span class="pre">(output</span> <span class="pre">src</span> <span class="pre">...)</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="inside.html#ats-depgen-output-src-for-internal-usage-only"><tt class="docutils literal"><span class="pre">ATS_DEPGEN</span> <span class="pre">(OUTPUT</span> <span class="pre">SRC)</span></tt>  <sub>(For internal usage only)</sub></a></li>
<li class="toctree-l2"><a class="reference internal" href="inside.html#ats-depgen-c-dep-for-internal-usage-only"><tt class="docutils literal"><span class="pre">ATS_DEPGEN_C</span> <span class="pre">(DEP)</span></tt>  <sub>(For internal usage only)</sub></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cmake.html">Useful CMake Commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cmake.html#target-link-libraries-target-libs"><tt class="docutils literal"><span class="pre">TARGET_LINK_LIBRARIES</span> <span class="pre">(target</span> <span class="pre">libs...)</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="cmake.html#add-executable-output-src"><tt class="docutils literal"><span class="pre">ADD_EXECUTABLE</span> <span class="pre">(output</span> <span class="pre">src</span> <span class="pre">...)</span></tt></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contacts.html">Contacts</a></li>
</ul>
</div>
</div></blockquote>
</div>
<div class="section" id="features">
<h1><span class="target" id="index-0"></span>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>It uses CMake, which is cross platform.</li>
<li>Automatic dependency resolving. This is especially useful, and is first supported by this projected.</li>
<li>Easy to use.</li>
</ul>
</div>
<div class="section" id="quick-start">
<h1><span class="target" id="index-1"></span>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h1>
<ul>
<li><p class="first"><span class="target" id="index-2"></span>Install CMake. You can download them from <a class="reference external" href="http://cmake.org/">CMake Website</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Version 2.8.3+ required, since <tt class="docutils literal"><span class="pre">ATS-CMake</span></tt> uses <tt class="docutils literal"><span class="pre">CMAKE_CURRENT_LIST_DIR</span></tt> variable</p>
</div>
</li>
<li><p class="first"><span class="target" id="index-3"></span>Install ATS from <a class="reference external" href="http://www.ats-lang.org/">ATS Website</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>You need to setup environment variables <tt class="docutils literal"><span class="pre">ATSHOME</span></tt> and <tt class="docutils literal"><span class="pre">PATH</span></tt> properly.
<tt class="docutils literal"><span class="pre">ATS-CMake</span></tt> use them to locate your currently available ATS binaries. For example:</p>
<div class="last highlight-python"><pre>export ATSHOME=/cs/coursedata/cs320/ATS029
export ATSHOMERELOC=ATS-0.2.9
export PATH=$PATH:$ATSHOME/bin</pre>
</div>
</div>
</li>
<li><p class="first">Download this project from <a class="reference external" href="https://github.com/steinwaywhw/ATS-CMake">GitHub</a>. Particularly, <tt class="docutils literal"><span class="pre">FindATS.cmake</span></tt> and <tt class="docutils literal"><span class="pre">ATSCC.cmake</span></tt>.</p>
</li>
<li><p class="first">Copy those <span class="target" id="index-4"></span>CMake modules into CMake module dir.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Normally, the module dir is <tt class="docutils literal"><span class="pre">/usr/share/cmake-x.x.x/Modules</span></tt>. You can find more information at <a class="reference external" href="http://cmake.org/">CMake Website</a>.</p>
</div>
</li>
<li><p class="first">Start using it!</p>
</li>
</ul>
</div>
<div class="section" id="hello-world">
<h1>Hello World<a class="headerlink" href="#hello-world" title="Permalink to this headline">¶</a></h1>
<p>Suppose you have a small project containing <tt class="docutils literal"><span class="pre">hello.sats</span></tt>, <tt class="docutils literal"><span class="pre">hello.dats</span></tt> and <tt class="docutils literal"><span class="pre">main.dats</span></tt>. Then, you need to write a <tt class="docutils literal"><span class="pre">CMakeLists.txt</span></tt> like the following</p>
<div class="highlight-cmake"><div class="highlight"><pre><span class="nb">CMAKE_MINIMUM_REQUIRED</span> <span class="p">(</span><span class="s">VERSION</span> <span class="s">2.8</span><span class="p">)</span>

<span class="c">#Specify project name as HELLOWORLD, and project language as C. Yes, it is C</span>
<span class="nb">PROJECT</span> <span class="p">(</span><span class="s">HELLOWORLD</span> <span class="s">C</span><span class="p">)</span>     

<span class="c">#Actually, this makes CMake to find ATSCC.cmake using FindATS.cmake</span>
<span class="nb">FIND_PACKAGE</span> <span class="p">(</span><span class="s">ATS</span> <span class="s">REQUIRED</span><span class="p">)</span> 

<span class="c">#The ATS_FOUND is automatically set by FindATS.cmake module</span>
<span class="nb">IF</span> <span class="p">(</span><span class="s">NOT</span> <span class="s">ATS_FOUND</span><span class="p">)</span> 
    <span class="nb">MESSAGE</span> <span class="p">(</span><span class="s">FATAL_ERROR</span> <span class="s2">&quot;ATS Not Found!&quot;</span><span class="p">)</span>
<span class="nb">ENDIF</span> <span class="p">()</span>

<span class="c">#ATS_COMIPLE is the core of this project. To put it simple, </span>
<span class="c">#you just specify related SATS/DATS files here, and use a variable</span>
<span class="c">#like TEST_SRC to store the outputs. ATS_COMPILE will analyze their </span>
<span class="c">#dependencies, compile them into C files, and store those C file </span>
<span class="c">#names into TEST_SRC</span>

<span class="c">#You can use ATS_INCLUDE to add search paths for the compiler to</span>
<span class="c">#find proper SATS/HATS files.    </span>
<span class="nb">ATS_COMPILE</span> <span class="p">(</span><span class="s">TEST_SRC</span> 
    <span class="s">hello.sats</span> 
    <span class="s">hello.dats</span> 
    <span class="s">main.dats</span><span class="p">)</span>

<span class="c">#It generate the final file &quot;test&quot; using all the C files in TEST_SRC.</span>
<span class="c">#And this is a standard CMake command</span>
<span class="nb">ADD_EXECUTABLE</span> <span class="p">(</span><span class="s">test</span> <span class="o">${</span><span class="nv">TEST_SRC</span><span class="o">}</span><span class="p">)</span> 
</pre></div>
</div>
<p>After you have a correct <tt class="docutils literal"><span class="pre">CMakeLists.txt</span></tt>, we just need to invoke <tt class="docutils literal"><span class="pre">cmake</span></tt>. But please make sure that you have a correct project layout.</p>
<div class="highlight-bash"><div class="highlight"><pre>HelloWorld
|   CMakeLists.txt
|   hello.dats
|   hello.sats
|   main.dats
|
<span class="se">\-</span>--build
        ...
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">I suggest using <em>out-of-source</em> <span class="target" id="index-5"></span>build, which makes everything clean, especially when you want to delete all temp files. See <a class="reference external" href="http://www.cmake.org/Wiki/CMake_FAQ#Out-of-source_build_trees">here</a> for more information. I use a <tt class="docutils literal"><span class="pre">./build</span></tt> dir for this purpose.</p>
</div>
<p>Now, go to <tt class="docutils literal"><span class="pre">./build</span></tt> and invoke <tt class="docutils literal"><span class="pre">cmake</span></tt>. It will generate a <tt class="docutils literal"><span class="pre">makefile</span></tt> for you under <tt class="docutils literal"><span class="pre">./build</span></tt>. You can invoke <tt class="docutils literal"><span class="pre">make</span></tt> now, to build the project as usual, and congratulations! The output binary will be under <tt class="docutils literal"><span class="pre">./build</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cd</span> <span class="o">./</span><span class="n">build</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmake</span> <span class="o">..</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">make</span>
<span class="gp">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We use <tt class="docutils literal"><span class="pre">cmake</span> <span class="pre">..</span></tt> because the present working directory is <tt class="docutils literal"><span class="pre">./build</span></tt>, while the <tt class="docutils literal"><span class="pre">CMakeLists.txt</span></tt> is in the parent directory. Therefore, it is <tt class="docutils literal"><span class="pre">cmake</span> <span class="pre">..</span></tt> instead of <tt class="docutils literal"><span class="pre">cmake</span> <span class="pre">.</span></tt>. Pay attention.</p>
</div>
</div>
<div class="section" id="what-s-next">
<h1>What&#8217;s Next<a class="headerlink" href="#what-s-next" title="Permalink to this headline">¶</a></h1>
<p>In the followings, I will try to cover more use cases, and then look into what&#8217;s happening in the CMake modules, so that you can better use them, and even help me develop it.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Welcome</a></li>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li><a class="reference internal" href="#hello-world">Hello World</a></li>
<li><a class="reference internal" href="#what-s-next">What&#8217;s Next</a></li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="examples.html"
                        title="next chapter">Examples</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             >next</a> |</li>
        <li><a href="#">ATS CMake latest documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Hanwen Wu.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>